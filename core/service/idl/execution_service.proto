/**
 * This file is auto generated by tto v0.4.5 !
 * If you want to modify this code, please read the guide
 * to modify code template.
 *
 * Get started: https://github.com/ixre/tto
 *
 * Copyright (C) 2009-2022 56X.NET, All rights reserved.
 *
 * name : job_exec_data_service.proto
 * author : jarrysix
 * date : 2022/03/06 03:16:21
 * description :
 * history :
 */




syntax = "proto3";
option go_package = "./;proto";
option java_package = "com.github.go2o.rpc";

import "global.proto";

/** JobExecData服务 */
service ExecutionService {
  /** 获取JobExecData */
  rpc GetJob (GetJobRequest) returns (SExecutionData) {
  }
  /** 更新任务执行游标 */
  rpc UpdateExecuteCursor (UpdateCursorRequest) returns (Result) {
  }

  /** 记录失败 */
  rpc AddFail(AddFailRequest)returns(Result){}

  rpc RejoinQueue(RejoinQueueRequest)returns(RejoinQueueResponse){}
}

message GetJobRequest{
  /** 任务名称 */
  string jobName = 1;
  /** 任务不存在时是否创建 */
  bool create = 2;
}

/** UpdateCursorRequest */
message UpdateCursorRequest{
  /** 任务名称 */
  string jobName = 1;
  /** 记录编号　*/
  int64 cursorId = 2;
}

message AddFailRequest{
  /** 任务名称 */
  string jobName = 1;
  /** 记录编号　*/
  int64 cursorId = 2;
}


/** JobExecData */
message SExecutionData{
  /** 编号 */
  int64 id = 1;
  /** 任务名称 */
  string jobName = 2;
  /** 上次执行位置索引 */
  int64 lastExecuteCursorId = 3;
  /** 最后执行时间 */
  int64 lastExecuteTime = 4;
}


/** 重新加入队列请求 */
message RejoinQueueRequest{
  /** 桶名称 */
  string bucketName = 1;
  /** 关联数据编号 */
  int64 relateId = 2;
  /** 数据 */
  string relateData = 3;
}

/** 保存重新加入队列响应 */
message RejoinQueueResponse{
  int32 errCode = 1;
  string errMsg = 2;
  int64 queueId = 3;
}
